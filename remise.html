<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Mon p'tit calculateur</title>
        <link href="assets/css/index.css" rel="stylesheet">
    </head>
    <body  >
        <header>
            <h1>Mon p'tit calculateur</h1>
        </header>
        <section class="container" >
             <a class="button" href="index.html">Sommaire</a>
            <form id="calculateur_remise">
                <h2>Calculateur de Remise</h2>
                <div >
                    <label class="" for="prix_ttc_avant_remise">Prix de vente TTC avant remise</label>
                    <input type="text" id="prix_ttc_avant_remise" name="prix_ttc_avant_remise">
                    <span >(Saisir le prix de vente avant remise)</span>
                </div>
            
                <div >
                    <label for="pourcentage_remise">% remise</label>
                    <input type="text" id="pourcentage_remise" name="pourcentage_remise" >
                    <span  >(Saisir le pourcentage de remise)</span>
                </div>
                 <hr />
                 <div class="pied_de_section" >   
                        <input type="button" id="calculer_remise" class="button" value="Calculer">
                        <span id="prixTTCApresRemise"> Cliquer sur Calculer pour obtenir le prix TTC après remise </span>
                 </div>
            </form>

            <article>
                La remise a pour formule :
                montant TTC avant remise - [ ( montant TTC avant remise X %remise ) /100 ]
                <br>

                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <!-- Arrowhead marker definition -->
                    <marker
                      id="arrow"
                      viewBox="0 0 10 10"
                      refX="5"
                      refY="5"
                      markerWidth="6"
                      markerHeight="6"
                      orient="auto-start-reverse">
                      <path d="M 0 0 L 10 5 L 0 10 z" />
                    </marker>

                    <!-- Dot marker definition -->
                    <marker
                      id="dot"
                      viewBox="0 0 10 10"
                      refX="5"
                      refY="5"
                      markerWidth="5"
                      markerHeight="5">
                      <circle cx="5" cy="5" r="5" fill="red" />
                    </marker>
                  </defs>

                  <!-- Coordinate axes with an arrowhead in both directions -->
                  <polyline
                    points="10,10 10,90 90,90"
                    fill="none"
                    stroke="black"
                    marker-start="url(#arrow)"
                    marker-end="url(#arrow)" />

                  <!-- Data line with polymarkers -->
                  <polyline
                    points="10 30,80 50"
                    fill="none"
                    stroke="grey"
                    marker-start="url(#dot)"
                    marker-mid="url(#dot)"
                    marker-end="url(#dot)" />

                    <text x="20" y="95"
                            font-family="Verdana"
                            font-size="5">
                         Taux de remise
                    </text>

                      <text x="0" y="80"
                            font-family="Verdana"
                            font-size="5"
                            transform="rotate(-90 0 , 75)"
                           >
                         Prix TTC après remise
                      </text>
                </svg>
            </article>
        </section>
    </body>
    <script>

        const button = document.querySelector('#calculer_remise');

        button.addEventListener('click', event => {
            const prixTTCAvantRemise = document.getElementById("prix_ttc_avant_remise").value;
            const pourcentageRemise = document.getElementById("pourcentage_remise").value;
            prixTTCApresRemise = Calculateur.prixApresRemise(prixTTCAvantRemise,pourcentageRemise)
            document.getElementById("prixTTCApresRemise").textContent = "Le prix TTC après remise est de : " + prixTTCApresRemise + "€"
        });

        class Calculateur {
            constructor() {
                console.log("calculateur")
            }
            static prixApresRemise(prixTTCAvantRemise, pourcentageRemise){
          
                const prixTTCAvantRemiseSanitized = parseFloat(prixTTCAvantRemise);
                const pourcentageRemiseSanitized = parseFloat(pourcentageRemise);
               
                if  (isNaN(prixTTCAvantRemiseSanitized)){
                    return 0;
                }

                if ((pourcentageRemiseSanitized===0) || isNaN(pourcentageRemiseSanitized)){
                    return prixTTCAvantRemiseSanitized;
                }

                let resultat = prixTTCAvantRemiseSanitized*(1-(pourcentageRemiseSanitized/100))
                               
                return  resultat;
        
            }

        }

        // ttc:200 remise:60 resultat 80 
        console.log("test calcul remise:" + (Calculateur.prixApresRemise(200,60)===80))
        console.log("test calcul remise sur texte €TTC :" + (Calculateur.prixApresRemise("texte",60)===0))
        console.log("test calcul remise 0 sur 200€TTC:" + (Calculateur.prixApresRemise(200,0)===200))
        console.log("test calcul remise texte sur 200€TTC:" + (Calculateur.prixApresRemise(200,"texte")===200))

    </script>
</html>
